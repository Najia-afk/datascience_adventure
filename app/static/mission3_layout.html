<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Mission 3: Data Exploration</title>
    <link rel="stylesheet" href="/styles/styles.css">
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
</head>

<body hx-boost="true">

    <!-- Sidebar -->
    <aside class="sidebar">
        <h2>Scripts Used in This Notebook:</h2>
        <ul>
            <li><a href="scripts/df_filtering.html" target="_blank">df_filtering.py</a></li>
            <li><a href="scripts/df_fuzzywuzzy.html" target="_blank">df_fuzzywuzzy.py</a></li>
            <li><a href="scripts/plot_nutriscore.html" target="_blank">plot_nutriscore.py</a></li>
            <li><a href="scripts/df_generator.html" target="_blank">df_generator.py</a></li>
            <li><a href="scripts/df_business_data_integrity.html" target="_blank">df_business_data_integrity.py</a></li>
        </ul>
    </aside>

    <!-- Main Content Area -->
    <section class="main-content">
        <div class="project-header">
            <h1>Mission 3: Data Exploration for a Public Health Agency</h1>
            <p>The Public Health Agency wishes to improve the quality of Open Food Facts data, an open source database made available to individuals and organizations.</p>
        </div>

        <!-- Google Colab Button -->
        <div class="button-container">
            <a href="https://colab.research.google.com/github/Datascience-Adventure/mission3/blob/main/Mission3.ipynb" target="_blank">
                Run on Google Colab
            </a>
        </div>

        <!-- Iframe Display for the Jupyter Notebook -->
        <div id="loading" style="display: block;">Loading...</div>
        <div class="iframe-container" style="display: none;">
            <iframe id="main-iframe" src="/mission3/Mission3.html" scrolling="no" style="width: 100%; border: none;"></iframe>
        </div>
    </section>

    <!-- JavaScript for Handling Iframe Resizing -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var iframe = document.getElementById('main-iframe');
            var loadingIndicator = document.getElementById('loading');
            var iframeContainer = document.querySelector('.iframe-container');

            // Listen for messages from the iframe
            window.addEventListener("message", function(event) {
                if (event.origin === "https://datascience-adventure.xyz") {
                    if (event.data && event.data.height) {
                        console.log("Setting iframe height to:", event.data.height);
                        iframe.style.height = event.data.height + 'px'; // Set the height of the iframe
                        loadingIndicator.style.display = 'none'; // Hide loading indicator
                        iframeContainer.style.display = 'block'; // Show iframe container
                    }
                } else {
                    console.error("Origin mismatch: " + event.origin);
                }
            }, false);

            // Ensure loading indicator is hidden when iframe is loaded
            iframe.onload = function() {
                setTimeout(function() {
                    var documentHeight = iframe.contentWindow.document.body.scrollHeight;
                    console.log("Iframe loaded. Document height:", documentHeight); // Log height
                    if (documentHeight > 0) {
                        iframe.style.height = documentHeight + 'px'; // Set height on load
                        loadingIndicator.style.display = 'none'; // Hide loading indicator
                        iframeContainer.style.display = 'block'; // Show iframe container
                    }
                }, 50000); // Adjust the delay as needed
            };
        });
    </script>
</body>

</html>
