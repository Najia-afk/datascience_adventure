<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission 3: Data Exploration</title>
    <link rel="stylesheet" href="/styles/styles.css">
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
</head>

<body hx-boost="true">
    <!-- Sidebar -->
    <aside class="sidebar">
        <h2>Scripts Used in This Notebook:</h2>
        <ul>
            <li><a href="scripts/df_filtering.html" target="_blank">df_filtering.py</a></li>
            <li><a href="scripts/df_fuzzywuzzy.html" target="_blank">df_fuzzywuzzy.py</a></li>
            <li><a href="scripts/plot_nutriscore.html" target="_blank">plot_nutriscore.py</a></li>
            <li><a href="scripts/df_generator.html" target="_blank">df_generator.py</a></li>
            <li><a href="scripts/df_business_data_integrity.html" target="_blank">df_business_data_integrity.py</a></li>
        </ul>
    </aside>

    <!-- Main Content Area -->
    <section class="main-content">
        <header class="project-header">
            <h1>Mission 3: Data Exploration for a Public Health Agency</h1>
            <p>The Public Health Agency wishes to improve the quality of Open Food Facts data, an open-source database available to individuals and organizations.</p>
        </header>

        <!-- Google Colab Button -->
        <div class="button-container">
            <a href="https://colab.research.google.com/github/Datascience-Adventure/mission3/blob/main/Mission3.ipynb" target="_blank">
                Run on Google Colab
            </a>
        </div>

        <!-- Iframe Display for the Jupyter Notebook -->
        <div id="loading" style="display: block;">Loading...</div>
        <div class="iframe-container" style="display: block;">
            <iframe id="main-iframe" src="/mission3/Mission3.html" scrolling="no" style="width: 100%; border: none;"></iframe>
        </div>
    </section>

    <!-- JavaScript for Handling Iframe Resizing -->
    <script>
        window.addEventListener('load', function() {
            const iframe = document.getElementById('main-iframe');
            const loadingIndicator = document.getElementById('loading');
            const iframeContainer = document.querySelector('.iframe-container');

            iframeContainer.style.display = 'none'; // Hide iframe container initially

            // Handle messages from the iframe for dynamic height adjustment
            window.addEventListener("message", function(event) {
                if (event.origin === "https://datascience-adventure.xyz") {
                    const { height } = event.data || {};
                    if (height) {
                        iframe.style.height = `${height}px`;
                        loadingIndicator.style.display = 'none';
                        iframeContainer.style.display = 'block';
                    }
                } else {
                    console.error(`Origin mismatch: ${event.origin}`);
                }
            });

            // Fallback: adjust iframe height if no message is received
            iframe.onload = function() {
                setTimeout(() => {
                    const documentHeight = iframe.contentWindow.document.body.scrollHeight;
                    if (documentHeight > 0) {
                        iframe.style.height = `${documentHeight}px`;
                        loadingIndicator.style.display = 'none';
                        iframeContainer.style.display = 'block';
                    }
                }, 10000); // Delay to allow content loading, adjust as needed
            };
        });
    </script>
</body>

</html>
